--학생 테이블 생성
CREATE TABLE STUDENTS(
  SCODE CHAR(6) NOT NULL PRIMARY KEY,
  SNAME VARCHAR(20) NOT NULL,
  DEPT VARCHAR(20) NOT NULL
);
DESC STUDENTS;

--과목 테이블 생성
CREATE TABLE COURSES(
  CCODE CHAR(3) NOT NULL PRIMARY KEY,
  CNAME VARCHAR(100) NOT NULL
);

--수강신청 테이블 생성
CREATE TABLE ENROLS(
  SCODE CHAR(6) NOT NULL,
  CCODE CHAR(3) NOT NULL,
  GRADE INT DEFAULT 0,
  EDATE DATE DEFAULT SYSDATE,
  PRIMARY KEY(SCODE, CCODE),
  FOREIGN KEY(SCODE) REFERENCES STUDENTS(SCODE),
  FOREIGN KEY(CCODE) REFERENCES COURSES(CCODE)
);

INSERT INTO STUDENTS(SCODE, SNAME, DEPT)
VALUES ('202301', '홍길동', '컴정');
INSERT INTO STUDENTS(SCODE, SNAME, DEPT)
VALUES ('202302', '김감찬', '컴정');
INSERT INTO STUDENTS(SCODE, SNAME, DEPT)
VALUES ('202303', '심청이', '컴정');

SELECT * FROM STUDENTS;

INSERT INTO COURSES(CCODE, CNAME)
VALUES ('100', '자바');
INSERT INTO COURSES(CCODE, CNAME)
VALUES ('101', '데이터베이스');
INSERT INTO COURSES(CCODE, CNAME)
VALUES ('102', 'HTML');

SELECT * FROM COURSES;

INSERT INTO ENROLS(SCODE, CCODE)
VALUES ('202301', '100');
INSERT INTO ENROLS(SCODE, CCODE)
VALUES ('202301', '102');
INSERT INTO ENROLS(SCODE, CCODE)
VALUES ('202302', '101');
INSERT INTO ENROLS(SCODE, CCODE)
VALUES ('202302', '102');
INSERT INTO ENROLS(SCODE, CCODE)
VALUES ('202303', '102');

SELECT * FROM ENROLS;

CREATE VIEW VIEW_ENROLS AS
SELECT E.*, S.SNAME, C.CNAME
FROM ENROLS E, STUDENTS S, COURSES C
WHERE E.SCODE=S.SCODE AND C.CCODE=E.CCODE;

SELECT * FROM VIEW_ENROLS ORDER BY SCODE;

COMMIT;

SELECT MAX(SCODE)+1 NCODE FROM STUDENTS;
INSERT INTO STUDENTS(SCODE, SNAME, DEPT)
VALUES (SELECT MAX(SCODE)+1 NCODE FROM STUDENTS, '김길동', '전자';

select * from view_enrols where scode = '202303';
select * from view_enrols where scode = '202301' and ccode = 102;